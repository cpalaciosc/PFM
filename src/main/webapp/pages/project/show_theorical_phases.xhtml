<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">
<h:body>
	<ui:composition template="#{root}/WEB-INF/template/commonLayout.xhtml">
		<ui:define name="header">
            Consultar fases teóricas
        </ui:define>
		<ui:define name="javascript">
			<script>
				var projectApp = angular.module('projectApp',
						[ "angularfaces" ]);
				app.value("$isTest", false);
			</script>
			<script src="/PFM/resources/js/controllers/projectApp.js"></script>
			<script src="/PFM/resources/js/controllers/scheduleController.js"></script>
			<script src="/PFM/resources/css/selectboxit/js/jquery.selectBoxIt.min.js"></script>
			<script src="/PFM/resources/js/libs/moment.js"></script>
			<script src="/PFM/resources/js/controllers/theoricalPhaseController.js"></script>
			<script>
				$(function() {
					var selectBox = $("#project").selectBoxIt();
				});
			</script>
		</ui:define>
		<ui:define name="css">
			<link href="/PFM/resources/css/bootstrap/css/bootstrap.min.css"
				rel="stylesheet" />
			<link
				href="/PFM/resources/css/selectboxit/css/jquery.selectBoxIt.css"
				rel="stylesheet" />
		</ui:define>
		<ui:define name="content">
			<div class="panel-body">
				<h:form prependId="false" ng-app="projectApp">
					<div ng-controller="scheduleController">
						<c:set var="projectBean" scope="request" value="#{showTheoricalPhasesBean}" />
						<ngsync direction="serverToClient"
							value="{{projectBean.projectSchedule}}" />						
							<fieldset>
								<ngsync direction="serverToClient"
									value="#{showTheoricalPhasesBean.project}" />
								<div class="row">
									<div class="col-lg-2">
										<p:outputLabel for="project" value="Proyecto: "
											styleClass="label_height" />
									</div>
									<div class="col-lg-2">
										<h:selectOneMenu id="project"
											value="#{showTheoricalPhasesBean.project.id}"
											immediate="true" onchange="submit()"
											valueChangeListener="#{showTheoricalPhasesBean.onChangeProject}">
											<f:selectItem itemLabel="Seleccione el proyecto"
												itemValue="-1" noSelectionOption="true" />
											<f:selectItems value="#{showTheoricalPhasesBean.projectList}"
												var="project" itemValue="#{project.id}"
												itemLabel="#{project.name}" />
										</h:selectOneMenu>
									</div>
								</div>
								<h:panelGroup rendered="#{not showTheoricalPhasesBean.emptyProject}">
									<div ng-if="runProject" ng-controller="theoricalPhaseController">
										<div class="row">
											<div class="col-lg-2">
												<p:outputLabel for="dias_recomendados"
													value="Días recomendados: " styleClass="label_height" />
											</div>
											<div class="col-lg-1">
												<h:outputText id="dias_recomendados"
													value="{{recomendedDays()}}"
													styleClass="ui-outputlabel ui-widget label_height" />
											</div>
											<div class="col-lg-2">
												<p:outputLabel for="dias_iteracion"
													value="Días por iteración: " styleClass="label_height" />
											</div>
											<div class="col-lg-2">
												<p:spinner id="dias_iteracion"
													value="{{showTheoricalPhasesBean.project.iterationDays}}"
													ng-required="true"
													validatorMessage="Número de días debe ser mayor a 0"
													stepFactor="0.5">
													<f:convertNumber minFractionDigits="2" maxFractionDigits="2"
														locale="en_US" />
													<f:validator
														validatorId="upm.miw.pfm.utils.GreaterThanZeroValidator" />
												</p:spinner>
											</div>
											<div class="col-lg-4" style="padding-left: 35px;">
												<p:message for="dias_iteracion" showDetail="true"
													showSummary="false" />
											</div>
										</div>
										<div class="padding-table">
											<p:commandButton value="Guardar"
												action="#{showTheoricalPhasesBean.process}" icon="ui-icon-disk"
												ajax="false" />
											<p:button outcome="index.html" value="Volver"
												icon="ui-icon-arrowreturn-1-w"></p:button>
										</div>
									</div>
								</h:panelGroup>
							</fieldset>
							<h:panelGroup rendered="#{not showTheoricalPhasesBean.emptyProject}">
								<div ng-if="runProject" ng-controller="theoricalPhaseController">
									<ngsync direction="serverToClient"
										value="{{showTheoricalPhasesBean.project}}" />
									<div role="tabpanel">
										<ul class="nav nav-tabs" role="tablist">
											<li role="presentation" class="active"><a href="#duration"
												aria-controls="duration" role="tab" data-toggle="tab">Duración</a></li>
											<li role="presentation"><a href="#effort"
												aria-controls="effort" role="tab" data-toggle="tab">Esfuerzo</a></li>
										</ul>
			
										<div class="tab-content">
											<div role="tabpanel" class="tab-pane active" id="duration">
												<ui:include src="duration_pannel.xhtml" />
											</div>
											<div role="tabpanel" class="tab-pane" id="effort">
												<ui:include src="effort_pannel.xhtml" />
											</div>
										</div>
									</div>
								</div>
							</h:panelGroup>	
					</div>
				</h:form>
			</div>
		</ui:define>
	</ui:composition>
</h:body>

</html>